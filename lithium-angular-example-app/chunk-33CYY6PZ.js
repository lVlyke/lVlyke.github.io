import{Fc as g,M as u,P as d,Tc as h,Uc as f,d as c,l as a,m as t}from"./chunk-EUM6DVGS.js";var o=c(h()),l=c(g());var U=(()=>{let r=class r{constructor(e){this.sessionUtils=e}encodeSecret(e){return btoa(e)}login(e,s){return this.loginAs({id:e,secret:this.encodeSecret(s)})}loginAs(e){let s=this.getUserById(e.id);return s?e.secret!==s.secret?t("Incorrect password."):(console.log(`Logged in as ${e.id}.`),this.sessionUtils.init(s)):t(`User "${e.id}" not found.`)}loginFromStore(){let e=this.sessionUtils.session;return!e||!e.user?t("No session found."):!e.user||!e.user.id||!e.user.secret?t("No session found."):(0,l.default)().isAfter(e.expiresDate)?t("Session is expired."):this.loginAs(e.user)}register(e,s,m){if(this.getUserById(s))return t(`User "${s}" already exists.`);let n={name:e,id:s,secret:this.encodeSecret(m),color:`rgb(${o.default.random(20,127)},${o.default.random(20,127)},${o.default.random(20,127)})`,hideBanner:!1,todoLists:{}};return this.usersStore=this.usersStore.concat([n]),a(n)}logout(){this.sessionUtils.invalidate()}getUserById(e,s){return o.default.find(this.usersStore,s?{id:e,secret:s}:{id:e})}get usersStore(){return localStorage.getItem("users")?JSON.parse(localStorage.getItem("users")):[]}set usersStore(e){localStorage.setItem("users",JSON.stringify(e||[]))}};r.\u0275fac=function(s){return new(s||r)(d(f))},r.\u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();export{U as a};
