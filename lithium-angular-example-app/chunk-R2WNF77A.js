import{Jc as g,Kc as l,M as a,P as u,d as n,l as c,m as r,vc as m}from"./chunk-DB74GNWI.js";var o=n(g()),d=n(m());var U=(()=>{class t{constructor(e){this.sessionUtils=e}encodeSecret(e){return btoa(e)}login(e,s){return this.loginAs({id:e,secret:this.encodeSecret(s)})}loginAs(e){let s=this.getUserById(e.id);return s?e.secret!==s.secret?r("Incorrect password."):(console.log(`Logged in as ${e.id}.`),this.sessionUtils.init(s)):r(`User "${e.id}" not found.`)}loginFromStore(){let e=this.sessionUtils.session;return!e||!e.user?r("No session found."):!e.user||!e.user.id||!e.user.secret?r("No session found."):(0,d.default)().isAfter(e.expiresDate)?r("Session is expired."):this.loginAs(e.user)}register(e,s,f){if(this.getUserById(s))return r(`User "${s}" already exists.`);let i={name:e,id:s,secret:this.encodeSecret(f),color:`rgb(${o.default.random(20,127)},${o.default.random(20,127)},${o.default.random(20,127)})`,hideBanner:!1,todoLists:{}};return this.usersStore=this.usersStore.concat([i]),c(i)}logout(){this.sessionUtils.invalidate()}getUserById(e,s){return o.default.find(this.usersStore,s?{id:e,secret:s}:{id:e})}get usersStore(){return localStorage.getItem("users")?JSON.parse(localStorage.getItem("users")):[]}set usersStore(e){localStorage.setItem("users",JSON.stringify(e||[]))}static{this.\u0275fac=function(s){return new(s||t)(u(l))}}static{this.\u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{U as a};
